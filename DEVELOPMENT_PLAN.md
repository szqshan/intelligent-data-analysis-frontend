# ğŸš€ å‰ç«¯å¼€å‘è®¡åˆ’ - è¯¦ç»†æ­¥éª¤æ‹†åˆ†

## ğŸ“Š é¡¹ç›®è¿›åº¦æ€»è§ˆ

| é˜¶æ®µ | çŠ¶æ€ | å®Œæˆæ—¶é—´ | å®é™…ç”¨æ—¶ | è¿›åº¦ |
|------|------|----------|----------|------|
| **Phase 1: åŸºç¡€æ¶æ„æ­å»º** | âœ… å·²å®Œæˆ | 2024-12-29 | 2å¤© | 100% |
| **Phase 2: æ ¸å¿ƒåŠŸèƒ½å¼€å‘** | ğŸš§ è¿›è¡Œä¸­ | - | Day 1å®Œæˆ | 25% |
| **Phase 3: æŠ¥å‘Šå±•ç¤ºå¼€å‘** | â³ è®¡åˆ’ä¸­ | - | - | 0% |
| **Phase 4: ä¼˜åŒ–å’Œéƒ¨ç½²** | â³ è®¡åˆ’ä¸­ | - | - | 0% |

**æ€»ä½“è¿›åº¦**: 37% âœ… (Phase 1å®Œæˆ + Phase 2 Day 1å®Œæˆ)

---

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**ç›®æ ‡**: å¼€å‘ä¸€ä¸ªç°ä»£åŒ–çš„Vue3å‰ç«¯åº”ç”¨ï¼Œæä¾›ç±»ä¼¼ChatGPT/Claudeçš„æ™ºèƒ½æ•°æ®åˆ†æç•Œé¢

**æŠ€æœ¯æ ˆ**: Vue 3 + Element Plus + Pinia + Vite + Axios

**å‰åç«¯åˆ†ç¦»**: å‰ç«¯è´Ÿè´£é¡µé¢æ¸²æŸ“å’Œå±•ç¤ºï¼Œåç«¯è´Ÿè´£AIåˆ†æå’Œæ•°æ®å¤„ç†

### ğŸ¯ å·²å®Œæˆæˆæœæ€»è§ˆ
- âœ… **Phase 1: åŸºç¡€æ¶æ„æ­å»º** - å®Œæ•´çš„Vue3å‰ç«¯æ¡†æ¶ï¼Œ5ä¸ªæ ¸å¿ƒé¡µé¢
- âœ… **Phase 2 Day 1: APIæœåŠ¡å±‚** - å®Œæ•´çš„APIæœåŠ¡å±‚å’ŒçŠ¶æ€ç®¡ç†åŸºç¡€

---

## âœ… Phase 1: åŸºç¡€æ¶æ„æ­å»º - å·²å®Œæˆ

> **å®Œæˆæ—¶é—´**: 2024-12-29  
> **å®é™…ç”¨æ—¶**: 2å¤©  
> **çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶é€šè¿‡æµ‹è¯•  

### ğŸ¯ å®Œæˆæˆæœ
- âœ… **é¡¹ç›®æ¶æ„**: å®Œæ•´çš„Vue3å‰ç«¯æ¡†æ¶ (Vue 3 + Element Plus + Vite)
- âœ… **5ä¸ªæ ¸å¿ƒé¡µé¢**: é¦–é¡µã€èŠå¤©ã€æŠ¥å‘Šã€å·¥å…·ã€è®¾ç½®
- âœ… **å“åº”å¼å¸ƒå±€**: æ”¯æŒæ¡Œé¢ç«¯ã€å¹³æ¿ç«¯ã€æ‰‹æœºç«¯
- âœ… **ç»„ä»¶ç³»ç»Ÿ**: Element Pluså®Œæ•´é›†æˆ
- âœ… **è·¯ç”±ç³»ç»Ÿ**: å•é¡µåº”ç”¨å¯¼èˆªå®Œæ•´
- âœ… **Bugä¿®å¤**: ä¸»é¡µé»‘å±é—®é¢˜ç­‰å·²è§£å†³

---

## ğŸ”„ Phase 2: æ ¸å¿ƒåŠŸèƒ½å¼€å‘ - è¿›è¡Œä¸­

> **å¼€å§‹æ—¶é—´**: 2024-12-30  
> **å½“å‰çŠ¶æ€**: ğŸš§ Day 1å·²å®Œæˆï¼ŒDay 2è¿›è¡Œä¸­

### ğŸ¯ Phase 2 ç›®æ ‡
åŸºäºå·²å®Œæˆçš„å‰ç«¯ç•Œé¢æ¡†æ¶ï¼Œé›†æˆåç«¯APIï¼Œå®ç°çœŸå®çš„æ•°æ®äº¤äº’åŠŸèƒ½ã€‚

### ğŸ“‹ ä¸»è¦ä»»åŠ¡
1. âœ… **APIæœåŠ¡é›†æˆ** - è¿æ¥åç«¯æ™ºèƒ½æ•°æ®åˆ†æAPI  
2. **èŠå¤©åŠŸèƒ½å®ç°** - å®ç°å®æ—¶èŠå¤©å’Œæµå¼å“åº”
3. **çŠ¶æ€ç®¡ç†å®Œå–„** - ç”¨æˆ·çŠ¶æ€ã€å¯¹è¯çŠ¶æ€ã€å·¥å…·çŠ¶æ€ç®¡ç†
4. **æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½** - æ”¯æŒæ•°æ®æ–‡ä»¶ä¸Šä¼ å’Œå¤„ç†
5. **å·¥å…·è°ƒç”¨å¯è§†åŒ–** - æ˜¾ç¤ºAIè°ƒç”¨å·¥å…·çš„è¿‡ç¨‹

### ğŸ—“ï¸ Day 1 (2024-12-30): APIæœåŠ¡å±‚æ­å»º âœ… å·²å®Œæˆ

> **å®Œæˆæ—¶é—´**: 2024-12-30  
> **çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶é€šè¿‡æµ‹è¯•  
> **æµ‹è¯•ç»“æœ**: 14/14é¡¹APIåŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼Œ100%æˆåŠŸç‡

#### âœ… å·²å®Œæˆä»»åŠ¡
- âœ… åˆ›å»ºHTTPå®¢æˆ·ç«¯é…ç½® (`src/utils/request.js`)
- âœ… åˆ›å»ºç”¨æˆ·è®¤è¯API (`src/api/user.js`) 
- âœ… åˆ›å»ºèŠå¤©APIæœåŠ¡ (`src/api/chat.js`)
- âœ… åˆ›å»ºæ–‡ä»¶ä¸Šä¼ API (`src/api/upload.js`)
- âœ… åˆ›å»ºAPIç»Ÿä¸€å¯¼å‡º (`src/api/index.js`)
- âœ… åˆ›å»ºå¸¸é‡é…ç½® (`src/utils/constants.js`)
- âœ… åˆ›å»ºç”¨æˆ·çŠ¶æ€ç®¡ç† (`src/stores/user.js`)
- âœ… åˆ›å»ºAPIæµ‹è¯•å·¥å…· (`src/utils/test-api.js`)
- âœ… åˆ›å»ºAPIæµ‹è¯•ç•Œé¢ (`src/views/ApiTest.vue`)
- âœ… é…ç½®Piniaåˆ°é¡¹ç›®å…¥å£æ–‡ä»¶

#### ğŸ¯ å®é™…å®Œæˆæˆæœ

**âœ… é¡¹ç›®ç»“æ„åˆ›å»ºå®Œæˆ**:
```
src/
â”œâ”€â”€ api/                  # APIæœåŠ¡å±‚
â”‚   â”œâ”€â”€ index.js         # âœ… APIç»Ÿä¸€å¯¼å‡º  
â”‚   â”œâ”€â”€ user.js          # âœ… ç”¨æˆ·è®¤è¯API
â”‚   â”œâ”€â”€ chat.js          # âœ… èŠå¤©API (å¯¹è¯ç®¡ç†ã€æµå¼å“åº”)
â”‚   â””â”€â”€ upload.js        # âœ… æ–‡ä»¶ä¸Šä¼ API
â”œâ”€â”€ stores/               # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ index.js         # âœ… çŠ¶æ€ç®¡ç†å¯¼å‡º
â”‚   â””â”€â”€ user.js          # âœ… ç”¨æˆ·çŠ¶æ€ç®¡ç†
â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ request.js       # âœ… HTTPè¯·æ±‚å°è£… (axios + è®¤è¯æ‹¦æˆªå™¨)
â”‚   â”œâ”€â”€ constants.js     # âœ… å¸¸é‡é…ç½®
â”‚   â””â”€â”€ test-api.js      # âœ… APIæµ‹è¯•å·¥å…·ç±»
â”œâ”€â”€ views/
â”‚   â””â”€â”€ ApiTest.vue      # âœ… APIæµ‹è¯•ç•Œé¢
â””â”€â”€ components/Chat/      # âœ… ç›®å½•ç»“æ„å°±ç»ª
```

**ğŸ”§ æ ¸å¿ƒæŠ€æœ¯å®ç°**:
- âœ… **HTTPå®¢æˆ·ç«¯**: Axioså®ä¾‹ï¼ŒbaseURLé…ç½®ï¼Œè®¤è¯å¤´è‡ªåŠ¨æ·»åŠ 
- âœ… **ç”¨æˆ·è®¤è¯**: APIå¯†é’¥éªŒè¯ã€ç³»ç»ŸçŠ¶æ€æ£€æŸ¥ã€å¥åº·æ£€æŸ¥
- âœ… **å¯¹è¯ç®¡ç†**: åˆ›å»ºå¯¹è¯ã€è·å–åˆ—è¡¨ã€æ¶ˆæ¯ç®¡ç†
- âœ… **æµå¼å“åº”**: SSEæ”¯æŒï¼Œå®æ—¶AIåˆ†æ
- âœ… **æ–‡ä»¶ä¸Šä¼ **: å¤šæ ¼å¼æ”¯æŒã€è¿›åº¦è·Ÿè¸ªã€å¤§å°éªŒè¯
- âœ… **é”™è¯¯å¤„ç†**: ç»Ÿä¸€é”™è¯¯æç¤ºï¼ŒElement Plusé›†æˆ
- âœ… **çŠ¶æ€ç®¡ç†**: Piniaé›†æˆï¼Œç”¨æˆ·è®¤è¯çŠ¶æ€æŒä¹…åŒ–

**ğŸ“Š å®Œæ•´åŠŸèƒ½æµ‹è¯•éªŒè¯**:
- âœ… å¥åº·æ£€æŸ¥ã€ç³»ç»ŸçŠ¶æ€æ£€æŸ¥
- âœ… APIå¯†é’¥æ ¼å¼éªŒè¯å’Œè®¤è¯éªŒè¯  
- âœ… æ–‡ä»¶ç±»å‹å’Œå¤§å°éªŒè¯
- âœ… å¯¹è¯åˆ›å»ºã€åˆ—è¡¨è·å–ã€å½“å‰å¯¹è¯ç®¡ç†
- âœ… æµå¼åˆ†æAPIè°ƒç”¨
- âœ… ç”¨æˆ·çŠ¶æ€åŒæ­¥å’ŒæŒä¹…åŒ–

### ğŸ—“ï¸ Day 2 (2024-12-31): çŠ¶æ€ç®¡ç†å®ç°

#### âœ… æ ¸å¿ƒä»»åŠ¡æ¸…å•
- âœ… åˆ›å»ºç”¨æˆ·çŠ¶æ€ç®¡ç† (`src/stores/user.js`) - å·²åœ¨Day 1å®Œæˆ
- [ ] åˆ›å»ºèŠå¤©çŠ¶æ€ç®¡ç† (`src/stores/chat.js`)
- [ ] åˆ›å»ºåº”ç”¨å…¨å±€çŠ¶æ€ (`src/stores/app.js`)
- [ ] å®ç°çŠ¶æ€æŒä¹…åŒ–
- [ ] æµ‹è¯•çŠ¶æ€ç®¡ç†åŠŸèƒ½

> **æ³¨**: ç”¨æˆ·çŠ¶æ€ç®¡ç†å·²åœ¨Day 1æå‰å®Œæˆï¼ŒDay 2é‡ç‚¹å®Œæˆå‰©ä½™çŠ¶æ€ç®¡ç†åŠŸèƒ½

#### ğŸ“‹ å…·ä½“å®æ–½æ­¥éª¤

**æ­¥éª¤1**: ç”¨æˆ·çŠ¶æ€ç®¡ç† (`src/stores/user.js`)
- çŠ¶æ€: `userId`, `username`, `apiKey`, `isAuthenticated`
- è®¡ç®—å±æ€§: `hasValidCredentials`
- æ–¹æ³•: `setCredentials()`, `validateAuth()`, `clearCredentials()`
- å®ç°localStorageæŒä¹…åŒ–

**æ­¥éª¤2**: èŠå¤©çŠ¶æ€ç®¡ç† (`src/stores/chat.js`)
- çŠ¶æ€: `conversations`, `currentConversationId`, `messages`, `isLoading`, `toolCalls`
- è®¡ç®—å±æ€§: `currentConversation`, `currentMessages`
- æ–¹æ³•: `createConversation()`, `sendMessage()`, `handleStreamResponse()`
- å®ç°æµå¼å“åº”å¤„ç†

**æ­¥éª¤3**: åº”ç”¨çŠ¶æ€ç®¡ç† (`src/stores/app.js`)
- ä¸»é¢˜è®¾ç½®ã€è¯­è¨€è®¾ç½®
- å…¨å±€åŠ è½½çŠ¶æ€
- é”™è¯¯çŠ¶æ€ç®¡ç†

### ğŸ—“ï¸ Day 3 (2025-01-01): èŠå¤©ç»„ä»¶å¼€å‘

#### âœ… æ ¸å¿ƒä»»åŠ¡æ¸…å•
- [ ] åˆ›å»ºæ¶ˆæ¯åˆ—è¡¨ç»„ä»¶ (`src/components/Chat/MessageList.vue`)
- [ ] åˆ›å»ºæ¶ˆæ¯è¾“å…¥ç»„ä»¶ (`src/components/Chat/MessageInput.vue`)
- [ ] åˆ›å»ºæ‰“å­—æŒ‡ç¤ºå™¨ç»„ä»¶
- [ ] å®ç°æ¶ˆæ¯æ ¼å¼åŒ– (Markdown, ä»£ç é«˜äº®)
- [ ] å®ç°æ–‡ä»¶ä¸Šä¼ UI

#### ğŸ“‹ å…·ä½“å®æ–½æ­¥éª¤

**æ­¥éª¤1**: æ¶ˆæ¯åˆ—è¡¨ç»„ä»¶ (`MessageList.vue`)
- æ”¯æŒç”¨æˆ·å’ŒAIæ¶ˆæ¯çš„ä¸åŒæ ·å¼
- é›†æˆMarkdownæ¸²æŸ“å’Œä»£ç é«˜äº®
- å®ç°è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
- æ·»åŠ æ¶ˆæ¯æ“ä½œ (å¤åˆ¶ã€é‡è¯•)
- å®ç°è™šæ‹Ÿæ»šåŠ¨ (æ€§èƒ½ä¼˜åŒ–)

**æ­¥éª¤2**: æ¶ˆæ¯è¾“å…¥ç»„ä»¶ (`MessageInput.vue`)
- å¤šè¡Œæ–‡æœ¬è¾“å…¥ï¼Œæ”¯æŒè‡ªåŠ¨è°ƒæ•´é«˜åº¦
- æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œæ”¯æŒæ‹–æ‹½ä¸Šä¼ 
- å¿«æ·é”®æ”¯æŒ (Enterå‘é€, Shift+Enteræ¢è¡Œ)
- æ–‡ä»¶é¢„è§ˆå’Œæ–‡ä»¶å¤§å°é™åˆ¶

**æ­¥éª¤3**: æ‰“å­—æŒ‡ç¤ºå™¨å’ŒåŠ è½½çŠ¶æ€
- CSSåŠ¨ç”»å®ç°æ‰“å­—æ•ˆæœ
- åŠ è½½çŠ¶æ€çš„ç”¨æˆ·å‹å¥½æç¤º

### ğŸ—“ï¸ Day 4 (2025-01-02): å·¥å…·å¯è§†åŒ–å’Œé›†æˆæµ‹è¯•

#### âœ… æ ¸å¿ƒä»»åŠ¡æ¸…å•
- [ ] åˆ›å»ºå·¥å…·è°ƒç”¨å¯è§†åŒ–ç»„ä»¶ (`src/components/Chat/ToolVisualization.vue`)
- [ ] åˆ›å»ºè®¤è¯å¯¹è¯æ¡† (`src/components/Auth/AuthDialog.vue`)
- [ ] æ›´æ–°ä¸»èŠå¤©ç•Œé¢é›†æˆæ‰€æœ‰ç»„ä»¶
- [ ] å®ç°ç»„åˆå¼å‡½æ•° (`src/composables/useChat.js`)
- [ ] ç«¯åˆ°ç«¯åŠŸèƒ½æµ‹è¯•

#### ğŸ“‹ å…·ä½“å®æ–½æ­¥éª¤

**æ­¥éª¤1**: å·¥å…·å¯è§†åŒ–ç»„ä»¶ (`ToolVisualization.vue`)
- ä½¿ç”¨Timelineç»„ä»¶å±•ç¤ºå·¥å…·è°ƒç”¨æµç¨‹
- æ”¯æŒå¤šç§ç»“æœç±»å‹ (å›¾è¡¨ã€è¡¨æ ¼ã€JSON)
- å¯æŠ˜å çš„è¯¦ç»†ä¿¡æ¯æ˜¾ç¤º
- é”™è¯¯çŠ¶æ€çš„å‹å¥½æç¤º

**æ­¥éª¤2**: è®¤è¯å¯¹è¯æ¡† (`AuthDialog.vue`)
- ç”¨æˆ·å‡­æ®è¾“å…¥è¡¨å•
- å®æ—¶éªŒè¯APIå¯†é’¥æ ¼å¼
- è®¤è¯çŠ¶æ€åé¦ˆ

**æ­¥éª¤3**: ä¸»ç•Œé¢é›†æˆ (`ChatInterface.vue`)
- é›†æˆæ‰€æœ‰èŠå¤©ç›¸å…³ç»„ä»¶
- å®ç°è®¤è¯æµç¨‹
- é”™è¯¯è¾¹ç•Œå¤„ç†

**æ­¥éª¤4**: ç»„åˆå¼å‡½æ•° (`useChat.js`)
- å°è£…èŠå¤©é€»è¾‘
- æ–‡ä»¶ä¸Šä¼ é€»è¾‘
- æ¶ˆæ¯å¤„ç†å·¥å…·å‡½æ•°

**æ­¥éª¤5**: åŠŸèƒ½æµ‹è¯•
- ç”¨æˆ·è®¤è¯æµç¨‹æµ‹è¯•
- æ¶ˆæ¯å‘é€å’Œæ¥æ”¶æµ‹è¯•
- æ–‡ä»¶ä¸Šä¼ æµ‹è¯•
- å·¥å…·è°ƒç”¨å¯è§†åŒ–æµ‹è¯•
- é”™è¯¯å¤„ç†æµ‹è¯•

---

## ğŸ“… Phase 2: æ ¸å¿ƒåŠŸèƒ½å¼€å‘ (Week 2) - è¯¦ç»†å®æ–½æ­¥éª¤

### ğŸ—“ï¸ Day 1 (2024-12-30): APIæœåŠ¡å±‚æ­å»º

#### ä»»åŠ¡1: åˆ›å»ºHTTPå®¢æˆ·ç«¯é…ç½®
**æ–‡ä»¶**: `src/utils/request.js`
```javascript
// HTTPè¯·æ±‚å°è£…ï¼Œæ”¯æŒè®¤è¯å’Œé”™è¯¯å¤„ç†
import axios from 'axios'
import { ElMessage } from 'element-plus'

const API_BASE_URL = 'http://localhost:5000/api'

// åˆ›å»ºaxioså®ä¾‹
const request = axios.create({
  baseURL: API_BASE_URL,
  timeout: 30000,
  headers: {
    'Content-Type': 'application/json'
  }
})

// è¯·æ±‚æ‹¦æˆªå™¨ - æ·»åŠ è®¤è¯ä¿¡æ¯
request.interceptors.request.use(
  config => {
    const userStore = useUserStore()
    if (userStore.userId && userStore.username && userStore.apiKey) {
      config.headers['X-User-ID'] = userStore.userId
      config.headers['X-Username'] = encodeURIComponent(userStore.username)
      config.headers['X-API-Key'] = userStore.apiKey
    }
    return config
  },
  error => Promise.reject(error)
)

// å“åº”æ‹¦æˆªå™¨ - ç»Ÿä¸€é”™è¯¯å¤„ç†
request.interceptors.response.use(
  response => response.data,
  error => {
    const message = error.response?.data?.message || error.message
    ElMessage.error(message)
    return Promise.reject(error)
  }
)

export default request
```

#### ä»»åŠ¡2: åˆ›å»ºç”¨æˆ·è®¤è¯API
**æ–‡ä»¶**: `src/api/user.js`
```javascript
import request from '@/utils/request'

export const userAPI = {
  // éªŒè¯ç”¨æˆ·è®¤è¯ä¿¡æ¯
  validateAuth(userInfo) {
    return request.get('/status', {
      headers: {
        'X-User-ID': userInfo.userId,
        'X-Username': encodeURIComponent(userInfo.username),
        'X-API-Key': userInfo.apiKey
      }
    })
  },

  // è·å–ç³»ç»ŸçŠ¶æ€
  getSystemStatus() {
    return request.get('/status')
  },

  // å¥åº·æ£€æŸ¥
  healthCheck() {
    return request.get('/health')
  }
}
```

#### ä»»åŠ¡3: åˆ›å»ºèŠå¤©APIæœåŠ¡
**æ–‡ä»¶**: `src/api/chat.js`
```javascript
import request from '@/utils/request'

export const chatAPI = {
  // åˆ›å»ºæ–°å¯¹è¯
  createConversation(data) {
    return request.post('/conversations', data)
  },

  // è·å–å¯¹è¯åˆ—è¡¨
  getConversations(userId) {
    return request.get('/conversations', { params: { user_id: userId } })
  },

  // è·å–å¯¹è¯æ¶ˆæ¯
  getMessages(conversationId) {
    return request.get(`/conversations/${conversationId}/messages`)
  },

  // å‘é€æ¶ˆæ¯ (æ”¯æŒæµå¼å“åº”)
  async sendMessage(conversationId, data) {
    const response = await fetch(`${request.defaults.baseURL}/conversations/${conversationId}/messages`, {
      method: 'POST',
      headers: {
        ...request.defaults.headers,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    })
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`)
    }
    
    return response // è¿”å›æµå¼å“åº”
  }
}
```

#### ä»»åŠ¡4: åˆ›å»ºæ–‡ä»¶ä¸Šä¼ API
**æ–‡ä»¶**: `src/api/upload.js`
```javascript
import request from '@/utils/request'

export const uploadAPI = {
  // ä¸Šä¼ æ–‡ä»¶
  uploadFile(file, userId, username) {
    const formData = new FormData()
    formData.append('file', file)
    formData.append('userId', userId)
    formData.append('username', username)
    
    return request.post('/upload', formData, {
      headers: {
        'Content-Type': 'multipart/form-data'
      },
      onUploadProgress: (progressEvent) => {
        const progress = Math.round((progressEvent.loaded * 100) / progressEvent.total)
        console.log(`Upload progress: ${progress}%`)
      }
    })
  }
}
```

### ğŸ—“ï¸ Day 2 (2024-12-31): çŠ¶æ€ç®¡ç†å®ç°

#### ä»»åŠ¡1: ç”¨æˆ·çŠ¶æ€ç®¡ç†
**æ–‡ä»¶**: `src/stores/user.js`
```javascript
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import { userAPI } from '@/api/user'

export const useUserStore = defineStore('user', () => {
  // çŠ¶æ€
  const userId = ref(localStorage.getItem('userId') || '')
  const username = ref(localStorage.getItem('username') || '')
  const apiKey = ref(localStorage.getItem('apiKey') || '')
  const isAuthenticated = ref(false)
  
  // è®¡ç®—å±æ€§
  const hasValidCredentials = computed(() => {
    return userId.value && username.value && apiKey.value
  })
  
  // æ–¹æ³•
  const setCredentials = (credentials) => {
    userId.value = credentials.userId
    username.value = credentials.username
    apiKey.value = credentials.apiKey
    
    // æŒä¹…åŒ–å­˜å‚¨
    localStorage.setItem('userId', credentials.userId)
    localStorage.setItem('username', credentials.username)
    localStorage.setItem('apiKey', credentials.apiKey)
  }
  
  const validateAuth = async () => {
    if (!hasValidCredentials.value) {
      isAuthenticated.value = false
      return false
    }
    
    try {
      await userAPI.validateAuth({
        userId: userId.value,
        username: username.value,
        apiKey: apiKey.value
      })
      isAuthenticated.value = true
      return true
    } catch (error) {
      isAuthenticated.value = false
      return false
    }
  }
  
  const clearCredentials = () => {
    userId.value = ''
    username.value = ''
    apiKey.value = ''
    isAuthenticated.value = false
    
    localStorage.removeItem('userId')
    localStorage.removeItem('username')
    localStorage.removeItem('apiKey')
  }
  
  return {
    // çŠ¶æ€
    userId,
    username,
    apiKey,
    isAuthenticated,
    // è®¡ç®—å±æ€§
    hasValidCredentials,
    // æ–¹æ³•
    setCredentials,
    validateAuth,
    clearCredentials
  }
})
```

#### ä»»åŠ¡2: èŠå¤©çŠ¶æ€ç®¡ç†
**æ–‡ä»¶**: `src/stores/chat.js`
```javascript
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import { chatAPI } from '@/api/chat'
import { useUserStore } from './user'

export const useChatStore = defineStore('chat', () => {
  const userStore = useUserStore()
  
  // çŠ¶æ€
  const conversations = ref([])
  const currentConversationId = ref(null)
  const messages = ref([])
  const isLoading = ref(false)
  const toolCalls = ref([])
  const uploadProgress = ref(0)
  
  // è®¡ç®—å±æ€§
  const currentConversation = computed(() => 
    conversations.value.find(c => c.id === currentConversationId.value)
  )
  
  const currentMessages = computed(() => 
    messages.value.filter(m => m.conversation_id === currentConversationId.value)
  )
  
  // æ–¹æ³•
  const createConversation = async (title = '', description = '') => {
    try {
      const response = await chatAPI.createConversation({
        title: title || 'æ–°å¯¹è¯',
        description,
        user_id: userStore.userId,
        api_key: userStore.apiKey
      })
      
      const newConversation = response.conversation
      conversations.value.unshift(newConversation)
      currentConversationId.value = newConversation.id
      
      return newConversation
    } catch (error) {
      console.error('åˆ›å»ºå¯¹è¯å¤±è´¥:', error)
      throw error
    }
  }
  
  const loadConversations = async () => {
    try {
      const response = await chatAPI.getConversations(userStore.userId)
      conversations.value = response.conversations || []
    } catch (error) {
      console.error('åŠ è½½å¯¹è¯å¤±è´¥:', error)
    }
  }
  
  const selectConversation = async (conversationId) => {
    currentConversationId.value = conversationId
    await loadMessages(conversationId)
  }
  
  const loadMessages = async (conversationId) => {
    try {
      const response = await chatAPI.getMessages(conversationId)
      messages.value = response.messages || []
    } catch (error) {
      console.error('åŠ è½½æ¶ˆæ¯å¤±è´¥:', error)
    }
  }
  
  const sendMessage = async (text, file = null) => {
    if (!currentConversationId.value) {
      await createConversation()
    }
    
    try {
      isLoading.value = true
      
      // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°æœ¬åœ°çŠ¶æ€
      const userMessage = {
        id: Date.now().toString(),
        conversation_id: currentConversationId.value,
        role: 'user',
        content: text,
        timestamp: new Date().toISOString(),
        file_info: file ? { name: file.name, size: file.size } : null
      }
      messages.value.push(userMessage)
      
      // å‘é€åˆ°åç«¯
      const response = await chatAPI.sendMessage(currentConversationId.value, {
        message: text,
        file: file
      })
      
      // å¤„ç†æµå¼å“åº”
      await handleStreamResponse(response)
      
    } catch (error) {
      console.error('å‘é€æ¶ˆæ¯å¤±è´¥:', error)
      throw error
    } finally {
      isLoading.value = false
    }
  }
  
  const handleStreamResponse = async (response) => {
    const reader = response.body.getReader()
    const decoder = new TextDecoder()
    
    let assistantMessage = {
      id: Date.now().toString(),
      conversation_id: currentConversationId.value,
      role: 'assistant',
      content: '',
      timestamp: new Date().toISOString()
    }
    
    messages.value.push(assistantMessage)
    
    try {
      while (true) {
        const { done, value } = await reader.read()
        if (done) break
        
        const chunk = decoder.decode(value)
        const lines = chunk.split('\n')
        
        for (const line of lines) {
          if (line.startsWith('data: ')) {
            const data = line.slice(6)
            if (data === '[DONE]') return
            
            try {
              const parsed = JSON.parse(data)
              
              if (parsed.type === 'message') {
                assistantMessage.content += parsed.content
              } else if (parsed.type === 'tool_call') {
                toolCalls.value.push(parsed.tool_call)
              } else if (parsed.type === 'tool_result') {
                const toolCall = toolCalls.value.find(tc => tc.id === parsed.tool_call_id)
                if (toolCall) {
                  toolCall.result = parsed.result
                }
              }
            } catch (e) {
              console.warn('è§£æSSEæ•°æ®å¤±è´¥:', e)
            }
          }
        }
      }
    } finally {
      reader.releaseLock()
    }
  }
  
  return {
    // çŠ¶æ€
    conversations,
    currentConversationId,
    messages,
    isLoading,
    toolCalls,
    uploadProgress,
    // è®¡ç®—å±æ€§
    currentConversation,
    currentMessages,
    // æ–¹æ³•
    createConversation,
    loadConversations,
    selectConversation,
    loadMessages,
    sendMessage
  }
})
```

### ğŸ—“ï¸ Day 3 (2025-01-01): èŠå¤©ç»„ä»¶å¼€å‘

#### ä»»åŠ¡1: æ¶ˆæ¯åˆ—è¡¨ç»„ä»¶
**æ–‡ä»¶**: `src/components/Chat/MessageList.vue`
```vue
<template>
  <div class="message-list" ref="messageContainer">
    <div 
      v-for="message in messages" 
      :key="message.id"
      class="message-wrapper"
      :class="{ 'user-message': message.role === 'user' }"
    >
      <div class="message">
        <div class="message-avatar">
          <el-avatar :size="32">
            <el-icon v-if="message.role === 'user'"><User /></el-icon>
            <el-icon v-else><Cpu /></el-icon>
          </el-avatar>
        </div>
        <div class="message-content">
          <div class="message-text" v-html="formatMessage(message.content)"></div>
          <div v-if="message.file_info" class="file-info">
            <el-tag type="info">
              <el-icon><Document /></el-icon>
              {{ message.file_info.name }}
            </el-tag>
          </div>
          <div class="message-time">
            {{ formatTime(message.timestamp) }}
          </div>
        </div>
        <div class="message-actions">
          <el-button text @click="copyMessage(message)">
            <el-icon><CopyDocument /></el-icon>
          </el-button>
          <el-button text @click="retryMessage(message)" v-if="message.role === 'user'">
            <el-icon><Refresh /></el-icon>
          </el-button>
        </div>
      </div>
    </div>
    
    <!-- æ‰“å­—æŒ‡ç¤ºå™¨ -->
    <div v-if="loading" class="typing-indicator">
      <div class="message">
        <div class="message-avatar">
          <el-avatar :size="32">
            <el-icon><Cpu /></el-icon>
          </el-avatar>
        </div>
        <div class="message-content">
          <div class="typing-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- æ»šåŠ¨åˆ°åº•éƒ¨æŒ‰é’® -->
    <el-button 
      v-if="showScrollButton"
      @click="scrollToBottom"
      class="scroll-button"
      type="primary"
      :icon="ArrowDown"
      circle
    />
  </div>
</template>

<script setup>
import { ref, nextTick, watch, onMounted } from 'vue'
import { marked } from 'marked'
import hljs from 'highlight.js'
import { ElMessage } from 'element-plus'

const props = defineProps({
  messages: {
    type: Array,
    default: () => []
  },
  loading: {
    type: Boolean,
    default: false
  }
})

const emit = defineEmits(['retry'])

const messageContainer = ref(null)
const showScrollButton = ref(false)

// é…ç½®marked
marked.setOptions({
  highlight: function(code, lang) {
    const language = hljs.getLanguage(lang) ? lang : 'plaintext'
    return hljs.highlight(code, { language }).value
  },
  langPrefix: 'hljs language-'
})

// æ ¼å¼åŒ–æ¶ˆæ¯å†…å®¹
const formatMessage = (content) => {
  return marked(content)
}

// æ ¼å¼åŒ–æ—¶é—´
const formatTime = (timestamp) => {
  return new Date(timestamp).toLocaleTimeString('zh-CN', {
    hour: '2-digit',
    minute: '2-digit'
  })
}

// æ»šåŠ¨åˆ°åº•éƒ¨
const scrollToBottom = () => {
  nextTick(() => {
    if (messageContainer.value) {
      messageContainer.value.scrollTop = messageContainer.value.scrollHeight
    }
  })
}

// å¤åˆ¶æ¶ˆæ¯
const copyMessage = async (message) => {
  try {
    await navigator.clipboard.writeText(message.content)
    ElMessage.success('æ¶ˆæ¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿')
  } catch {
    ElMessage.error('å¤åˆ¶å¤±è´¥')
  }
}

// é‡è¯•æ¶ˆæ¯
const retryMessage = (message) => {
  emit('retry', message)
}

// ç›‘å¬æ¶ˆæ¯å˜åŒ–ï¼Œè‡ªåŠ¨æ»šåŠ¨
watch(() => props.messages.length, () => {
  scrollToBottom()
})

// ç›‘å¬æ»šåŠ¨ï¼Œæ˜¾ç¤º/éšè—æ»šåŠ¨æŒ‰é’®
const handleScroll = () => {
  if (messageContainer.value) {
    const { scrollTop, scrollHeight, clientHeight } = messageContainer.value
    showScrollButton.value = scrollHeight - scrollTop - clientHeight > 100
  }
}

onMounted(() => {
  messageContainer.value?.addEventListener('scroll', handleScroll)
})
</script>

<style scoped>
.message-list {
  flex: 1;
  overflow-y: auto;
  padding: 1rem;
  position: relative;
}

.message-wrapper {
  margin-bottom: 1rem;
}

.message {
  display: flex;
  gap: 0.75rem;
  align-items: flex-start;
}

.user-message .message {
  flex-direction: row-reverse;
}

.message-content {
  flex: 1;
  background: var(--el-bg-color-page);
  padding: 0.75rem 1rem;
  border-radius: 8px;
  position: relative;
}

.user-message .message-content {
  background: var(--el-color-primary-light-9);
}

.message-text {
  line-height: 1.6;
  word-wrap: break-word;
}

.file-info {
  margin-top: 0.5rem;
}

.message-time {
  font-size: 0.75rem;
  color: var(--el-text-color-placeholder);
  margin-top: 0.5rem;
}

.message-actions {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  opacity: 0;
  transition: opacity 0.2s;
}

.message:hover .message-actions {
  opacity: 1;
}

.typing-indicator {
  margin-bottom: 1rem;
}

.typing-dots {
  display: flex;
  gap: 0.25rem;
  padding: 0.5rem 0;
}

.typing-dots span {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--el-color-primary);
  animation: typing 1.4s infinite ease-in-out;
}

.typing-dots span:nth-child(1) { animation-delay: -0.32s; }
.typing-dots span:nth-child(2) { animation-delay: -0.16s; }
.typing-dots span:nth-child(3) { animation-delay: 0s; }

@keyframes typing {
  0%, 80%, 100% {
    transform: scale(0);
    opacity: 0.5;
  }
  40% {
    transform: scale(1);
    opacity: 1;
  }
}

.scroll-button {
  position: absolute;
  bottom: 1rem;
  right: 1rem;
  z-index: 10;
}
</style>
```

#### ä»»åŠ¡2: æ¶ˆæ¯è¾“å…¥ç»„ä»¶
**æ–‡ä»¶**: `src/components/Chat/MessageInput.vue`
```vue
<template>
  <div class="message-input">
    <div class="input-wrapper">
      <!-- æ–‡ä»¶ä¸Šä¼  -->
      <el-upload
        ref="uploadRef"
        :show-file-list="false"
        :before-upload="handleFileSelect"
        accept=".csv,.xlsx,.json,.txt,.pdf"
        :disabled="disabled"
      >
        <el-button :icon="Paperclip" circle :disabled="disabled" />
      </el-upload>
      
      <!-- æ–‡æœ¬è¾“å…¥æ¡† -->
      <el-input
        v-model="inputText"
        type="textarea"
        :rows="1"
        :autosize="{ minRows: 1, maxRows: 5 }"
        placeholder="è¾“å…¥æ¶ˆæ¯... (Shift+Enteræ¢è¡Œï¼ŒEnterå‘é€)"
        @keydown="handleKeydown"
        :disabled="disabled"
        class="message-textarea"
      />
      
      <!-- å‘é€æŒ‰é’® -->
      <el-button
        type="primary"
        :icon="Send"
        @click="handleSend"
        :disabled="!canSend"
        :loading="disabled"
      >
        å‘é€
      </el-button>
    </div>
    
    <!-- æ–‡ä»¶é¢„è§ˆ -->
    <div v-if="selectedFile" class="file-preview">
      <el-tag closable @close="selectedFile = null">
        <el-icon><Document /></el-icon>
        {{ selectedFile.name }} ({{ formatFileSize(selectedFile.size) }})
      </el-tag>
    </div>
    
    <!-- è¾“å…¥æç¤º -->
    <div class="input-hint">
      <span>æ”¯æŒä¸Šä¼ : CSVã€Excelã€JSONã€TXTã€PDFæ–‡ä»¶</span>
      <span>å¿«æ·é”®: Ctrl+Enterå‘é€</span>
    </div>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue'
import { ElMessage } from 'element-plus'

const props = defineProps({
  disabled: {
    type: Boolean,
    default: false
  }
})

const emit = defineEmits(['send', 'upload'])

const inputText = ref('')
const selectedFile = ref(null)

const canSend = computed(() => {
  return (inputText.value.trim() || selectedFile.value) && !props.disabled
})

const handleSend = () => {
  if (!canSend.value) return
  
  emit('send', inputText.value.trim(), selectedFile.value)
  inputText.value = ''
  selectedFile.value = null
}

const handleKeydown = (event) => {
  if (event.key === 'Enter' && !event.shiftKey) {
    event.preventDefault()
    handleSend()
  } else if (event.ctrlKey && event.key === 'Enter') {
    event.preventDefault()
    handleSend()
  }
}

const handleFileSelect = (file) => {
  // æ–‡ä»¶å¤§å°é™åˆ¶ (10MB)
  const maxSize = 10 * 1024 * 1024
  if (file.size > maxSize) {
    ElMessage.error('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡10MB')
    return false
  }
  
  selectedFile.value = file
  return false // é˜»æ­¢è‡ªåŠ¨ä¸Šä¼ 
}

const formatFileSize = (bytes) => {
  if (bytes === 0) return '0 Bytes'
  const k = 1024
  const sizes = ['Bytes', 'KB', 'MB', 'GB']
  const i = Math.floor(Math.log(bytes) / Math.log(k))
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]
}
</script>

<style scoped>
.message-input {
  padding: 1rem;
  border-top: 1px solid var(--el-border-color);
  background: var(--el-bg-color);
}

.input-wrapper {
  display: flex;
  gap: 0.75rem;
  align-items: flex-end;
}

.message-textarea {
  flex: 1;
}

.file-preview {
  margin-top: 0.75rem;
  padding: 0.5rem;
  background: var(--el-bg-color-page);
  border-radius: 6px;
}

.input-hint {
  display: flex;
  justify-content: space-between;
  margin-top: 0.5rem;
  font-size: 0.75rem;
  color: var(--el-text-color-placeholder);
}

@media (max-width: 768px) {
  .input-hint {
    flex-direction: column;
    gap: 0.25rem;
  }
}
</style>
```

### ğŸ—“ï¸ Day 4 (2025-01-02): å·¥å…·å¯è§†åŒ–å’Œé›†æˆæµ‹è¯•

#### ä»»åŠ¡1: å·¥å…·è°ƒç”¨å¯è§†åŒ–ç»„ä»¶
**æ–‡ä»¶**: `src/components/Chat/ToolVisualization.vue`
```vue
<template>
  <div class="tool-visualization" v-if="toolCalls.length > 0">
    <el-card class="tool-card">
      <template #header>
        <div class="tool-header">
          <el-icon class="tool-icon"><Tools /></el-icon>
          <span class="tool-title">AIå·¥å…·è°ƒç”¨è¿‡ç¨‹</span>
          <el-tag :type="statusType" size="small">{{ statusText }}</el-tag>
        </div>
      </template>
      
      <el-timeline>
        <el-timeline-item
          v-for="(tool, index) in toolCalls"
          :key="tool.id"
          :type="getTimelineType(tool.status)"
          :icon="getTimelineIcon(tool.status)"
          :timestamp="formatTime(tool.timestamp)"
        >
          <div class="tool-step">
            <div class="step-header">
              <h4>{{ tool.function?.name || `å·¥å…· ${index + 1}` }}</h4>
              <el-tag :type="getStatusType(tool.status)" size="small">
                {{ getStatusText(tool.status) }}
              </el-tag>
            </div>
            
            <div class="step-description">
              {{ tool.function?.description || 'æ‰§è¡Œæ•°æ®åˆ†æå·¥å…·' }}
            </div>
            
            <!-- è¾“å…¥å‚æ•° -->
            <el-collapse v-if="tool.function?.arguments" class="step-details">
              <el-collapse-item title="è¾“å…¥å‚æ•°" name="input">
                <pre class="code-block">{{ formatJSON(tool.function.arguments) }}</pre>
              </el-collapse-item>
            </el-collapse>
            
            <!-- æ‰§è¡Œç»“æœ -->
            <el-collapse v-if="tool.result" class="step-details">
              <el-collapse-item title="æ‰§è¡Œç»“æœ" name="output">
                <div v-if="tool.result.type === 'chart'" class="chart-result">
                  <img :src="tool.result.data" alt="ç”Ÿæˆçš„å›¾è¡¨" class="chart-image" />
                </div>
                <div v-else-if="tool.result.type === 'table'" class="table-result">
                  <el-table :data="tool.result.data" style="width: 100%">
                    <el-table-column
                      v-for="column in Object.keys(tool.result.data[0] || {})"
                      :key="column"
                      :prop="column"
                      :label="column"
                    />
                  </el-table>
                </div>
                <pre v-else class="code-block">{{ formatResult(tool.result) }}</pre>
              </el-collapse-item>
            </el-collapse>
            
            <!-- é”™è¯¯ä¿¡æ¯ -->
            <el-alert
              v-if="tool.error"
              type="error"
              :title="tool.error.message"
              :description="tool.error.details"
              show-icon
              class="error-alert"
            />
          </div>
        </el-timeline-item>
      </el-timeline>
    </el-card>
  </div>
</template>

<script setup>
import { computed } from 'vue'

const props = defineProps({
  toolCalls: {
    type: Array,
    default: () => []
  }
})

const statusType = computed(() => {
  if (props.toolCalls.some(tool => tool.status === 'error')) return 'danger'
  if (props.toolCalls.every(tool => tool.status === 'completed')) return 'success'
  return 'warning'
})

const statusText = computed(() => {
  if (props.toolCalls.some(tool => tool.status === 'error')) return 'æ‰§è¡Œå¤±è´¥'
  if (props.toolCalls.every(tool => tool.status === 'completed')) return 'æ‰§è¡Œå®Œæˆ'
  return 'æ‰§è¡Œä¸­'
})

const getTimelineType = (status) => {
  switch (status) {
    case 'completed': return 'success'
    case 'error': return 'danger'
    case 'running': return 'warning'
    default: return 'info'
  }
}

const getTimelineIcon = (status) => {
  switch (status) {
    case 'completed': return 'Check'
    case 'error': return 'Close'
    case 'running': return 'Loading'
    default: return 'Clock'
  }
}

const getStatusType = (status) => {
  switch (status) {
    case 'completed': return 'success'
    case 'error': return 'danger'
    case 'running': return 'warning'
    default: return 'info'
  }
}

const getStatusText = (status) => {
  switch (status) {
    case 'completed': return 'å®Œæˆ'
    case 'error': return 'å¤±è´¥'
    case 'running': return 'æ‰§è¡Œä¸­'
    default: return 'ç­‰å¾…'
  }
}

const formatTime = (timestamp) => {
  return new Date(timestamp).toLocaleTimeString('zh-CN')
}

const formatJSON = (obj) => {
  return JSON.stringify(obj, null, 2)
}

const formatResult = (result) => {
  if (typeof result === 'object') {
    return JSON.stringify(result, null, 2)
  }
  return result
}
</script>

<style scoped>
.tool-visualization {
  margin: 1rem 0;
}

.tool-card {
  border: 1px solid var(--el-color-primary-light-7);
}

.tool-header {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.tool-icon {
  color: var(--el-color-primary);
}

.tool-title {
  flex: 1;
  font-weight: 600;
}

.tool-step {
  padding: 0.5rem 0;
}

.step-header {
  display: flex;
  justify-content: between;
  align-items: center;
  margin-bottom: 0.5rem;
}

.step-header h4 {
  margin: 0;
  color: var(--el-text-color-primary);
}

.step-description {
  color: var(--el-text-color-regular);
  margin-bottom: 0.75rem;
}

.step-details {
  margin: 0.75rem 0;
}

.code-block {
  background: var(--el-fill-color-light);
  padding: 1rem;
  border-radius: 6px;
  font-family: 'Monaco', 'Consolas', monospace;
  font-size: 0.875rem;
  overflow-x: auto;
  margin: 0;
}

.chart-result {
  text-align: center;
}

.chart-image {
  max-width: 100%;
  height: auto;
  border: 1px solid var(--el-border-color);
  border-radius: 6px;
}

.table-result {
  margin: 0.5rem 0;
}

.error-alert {
  margin-top: 0.75rem;
}
</style>
```

#### ä»»åŠ¡2: æ›´æ–°ChatInterface.vueé›†æˆæ‰€æœ‰ç»„ä»¶
**æ–‡ä»¶**: `src/views/ChatInterface.vue` (å¤§å¹…æ›´æ–°)
```vue
<template>
  <div class="chat-interface">
    <!-- è®¤è¯å¼¹çª— -->
    <AuthDialog v-model="showAuthDialog" @authenticated="handleAuthenticated" />
    
    <div class="chat-container">
      <!-- æ¶ˆæ¯åˆ—è¡¨ -->
      <MessageList 
        :messages="chatStore.currentMessages"
        :loading="chatStore.isLoading"
        @retry="retryMessage"
        class="message-area"
      />
      
      <!-- å·¥å…·è°ƒç”¨å¯è§†åŒ– -->
      <ToolVisualization 
        :tool-calls="chatStore.toolCalls"
        v-if="chatStore.toolCalls.length > 0"
      />
      
      <!-- è¾“å…¥åŒºåŸŸ -->
      <MessageInput 
        @send="sendMessage"
        :disabled="chatStore.isLoading || !userStore.isAuthenticated"
        class="input-area"
      />
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import { useChatStore } from '@/stores/chat'
import { useUserStore } from '@/stores/user'
import MessageList from '@/components/Chat/MessageList.vue'
import MessageInput from '@/components/Chat/MessageInput.vue'
import ToolVisualization from '@/components/Chat/ToolVisualization.vue'
import AuthDialog from '@/components/Auth/AuthDialog.vue'

const chatStore = useChatStore()
const userStore = useUserStore()
const showAuthDialog = ref(false)

onMounted(async () => {
  // æ£€æŸ¥è®¤è¯çŠ¶æ€
  if (!userStore.hasValidCredentials) {
    showAuthDialog.value = true
  } else {
    const isValid = await userStore.validateAuth()
    if (!isValid) {
      showAuthDialog.value = true
    } else {
      await chatStore.loadConversations()
    }
  }
})

const handleAuthenticated = async () => {
  showAuthDialog.value = false
  await chatStore.loadConversations()
}

const sendMessage = async (text, file) => {
  try {
    await chatStore.sendMessage(text, file)
  } catch (error) {
    console.error('å‘é€æ¶ˆæ¯å¤±è´¥:', error)
  }
}

const retryMessage = async (message) => {
  try {
    await chatStore.sendMessage(message.content)
  } catch (error) {
    console.error('é‡è¯•æ¶ˆæ¯å¤±è´¥:', error)
  }
}
</script>

<style scoped>
.chat-interface {
  height: 100vh;
  display: flex;
  flex-direction: column;
}

.chat-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.message-area {
  flex: 1;
  overflow: hidden;
}

.input-area {
  flex-shrink: 0;
}
</style>
```

#### ä»»åŠ¡3: åˆ›å»ºè®¤è¯å¯¹è¯æ¡†ç»„ä»¶
**æ–‡ä»¶**: `src/components/Auth/AuthDialog.vue`
```vue
<template>
  <el-dialog
    v-model="visible"
    title="ç”¨æˆ·è®¤è¯"
    width="500px"
    :close-on-click-modal="false"
    :close-on-press-escape="false"
    :show-close="false"
  >
    <el-form :model="form" :rules="rules" ref="formRef" label-width="100px">
      <el-form-item label="ç”¨æˆ·ID" prop="userId">
        <el-input v-model="form.userId" placeholder="è¯·è¾“å…¥ç”¨æˆ·ID" />
      </el-form-item>
      
      <el-form-item label="ç”¨æˆ·å" prop="username">
        <el-input v-model="form.username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" />
      </el-form-item>
      
      <el-form-item label="APIå¯†é’¥" prop="apiKey">
        <el-input
          v-model="form.apiKey"
          type="password"
          placeholder="è¯·è¾“å…¥Anthropic APIå¯†é’¥"
          show-password
        />
        <div class="api-hint">
          <el-text size="small" type="info">
            éœ€è¦æœ‰æ•ˆçš„Anthropic APIå¯†é’¥ (sk-ant-api-...)
          </el-text>
        </div>
      </el-form-item>
    </el-form>
    
    <template #footer>
      <el-button @click="handleCancel">å–æ¶ˆ</el-button>
      <el-button type="primary" @click="handleConfirm" :loading="loading">
        ç¡®è®¤å¹¶éªŒè¯
      </el-button>
    </template>
  </el-dialog>
</template>

<script setup>
import { ref, watch } from 'vue'
import { useUserStore } from '@/stores/user'
import { ElMessage } from 'element-plus'

const props = defineProps({
  modelValue: Boolean
})

const emit = defineEmits(['update:modelValue', 'authenticated'])

const userStore = useUserStore()
const visible = ref(false)
const loading = ref(false)
const formRef = ref(null)

const form = ref({
  userId: userStore.userId,
  username: userStore.username,
  apiKey: userStore.apiKey
})

const rules = {
  userId: [{ required: true, message: 'è¯·è¾“å…¥ç”¨æˆ·ID', trigger: 'blur' }],
  username: [{ required: true, message: 'è¯·è¾“å…¥ç”¨æˆ·å', trigger: 'blur' }],
  apiKey: [
    { required: true, message: 'è¯·è¾“å…¥APIå¯†é’¥', trigger: 'blur' },
    { pattern: /^sk-ant-api-/, message: 'APIå¯†é’¥æ ¼å¼ä¸æ­£ç¡®', trigger: 'blur' }
  ]
}

watch(() => props.modelValue, (val) => {
  visible.value = val
})

watch(visible, (val) => {
  emit('update:modelValue', val)
})

const handleConfirm = async () => {
  try {
    await formRef.value.validate()
    
    loading.value = true
    
    // è®¾ç½®è®¤è¯ä¿¡æ¯
    userStore.setCredentials(form.value)
    
    // éªŒè¯è®¤è¯ä¿¡æ¯
    const isValid = await userStore.validateAuth()
    
    if (isValid) {
      ElMessage.success('è®¤è¯æˆåŠŸ')
      visible.value = false
      emit('authenticated')
    } else {
      ElMessage.error('è®¤è¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ‚¨çš„å‡­æ®')
    }
  } catch (error) {
    console.error('è®¤è¯å¤±è´¥:', error)
  } finally {
    loading.value = false
  }
}

const handleCancel = () => {
  visible.value = false
}
</script>

<style scoped>
.api-hint {
  margin-top: 0.25rem;
}
</style>
```

### ğŸ“‹ Phase 2 å®ŒæˆéªŒæ”¶æ ‡å‡†

#### âœ… åŠŸèƒ½éªŒæ”¶
1. **ç”¨æˆ·è®¤è¯**: æ”¯æŒç”¨æˆ·IDã€ç”¨æˆ·åã€APIå¯†é’¥è®¤è¯
2. **èŠå¤©åŠŸèƒ½**: æ”¯æŒå‘é€æ–‡æœ¬æ¶ˆæ¯å’Œæ–‡ä»¶ä¸Šä¼ 
3. **æµå¼å“åº”**: å®æ—¶æ˜¾ç¤ºAIå›å¤è¿‡ç¨‹
4. **å·¥å…·å¯è§†åŒ–**: å±•ç¤ºAIå·¥å…·è°ƒç”¨è¿‡ç¨‹å’Œç»“æœ
5. **çŠ¶æ€ç®¡ç†**: ç”¨æˆ·çŠ¶æ€å’ŒèŠå¤©çŠ¶æ€æŒä¹…åŒ–
6. **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯æç¤ºå’Œé‡è¯•æœºåˆ¶

#### ğŸ¯ æŠ€æœ¯éªŒæ”¶
1. **APIé›†æˆ**: æ‰€æœ‰åç«¯æ¥å£è°ƒç”¨æ­£å¸¸
2. **ç»„ä»¶å¤ç”¨**: èŠå¤©ç›¸å…³ç»„ä»¶å¯ç‹¬ç«‹ä½¿ç”¨
3. **å“åº”å¼è®¾è®¡**: æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨ç«¯
4. **æ€§èƒ½ä¼˜åŒ–**: æ¶ˆæ¯åˆ—è¡¨æ”¯æŒå¤§é‡æ•°æ®
5. **ä»£ç è´¨é‡**: ç¬¦åˆVue 3æœ€ä½³å®è·µ

### Day 8-10: èŠå¤©ç•Œé¢å®ç° (åŸæœ‰è®¡åˆ’ä¿ç•™)

#### 4.1 åˆ›å»ºèŠå¤©é¡µé¢å¸ƒå±€
```vue
<!-- src/views/Chat/ChatInterface.vue -->
<template>
  <div class="chat-interface">
    <!-- ä¾§è¾¹æ ï¼šå¯¹è¯å†å² -->
    <div class="chat-sidebar">
      <ChatHistory 
        :conversations="conversations"
        @select="selectConversation"
        @create="createConversation"
      />
    </div>
    
    <!-- ä¸»èŠå¤©åŒºåŸŸ -->
    <div class="chat-main">
      <!-- æ¶ˆæ¯åˆ—è¡¨ -->
      <div class="message-container">
        <MessageList 
          :messages="currentMessages"
          :loading="isLoading"
        />
      </div>
      
      <!-- å·¥å…·è°ƒç”¨å¯è§†åŒ– -->
      <ToolCallVisualization 
        v-if="showToolCall"
        :tool-calls="currentToolCalls"
      />
      
      <!-- è¾“å…¥åŒºåŸŸ -->
      <div class="input-container">
        <MessageInput 
          @send="sendMessage"
          @upload="handleFileUpload"
          :disabled="isLoading"
        />
      </div>
    </div>
  </div>
</template>
```

#### 4.2 æ ¸å¿ƒç»„ä»¶å¼€å‘

**MessageListç»„ä»¶**:
```vue
<!-- src/components/Chat/MessageList.vue -->
<template>
  <div class="message-list" ref="messageContainer">
    <div 
      v-for="message in messages" 
      :key="message.id"
      class="message-wrapper"
      :class="{ 'user-message': message.role === 'user' }"
    >
      <MessageItem 
        :message="message"
        :show-avatar="true"
        @retry="$emit('retry', message)"
      />
    </div>
    
    <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
    <TypingIndicator v-if="loading" />
    
    <!-- æ»šåŠ¨åˆ°åº•éƒ¨æŒ‰é’® -->
    <el-button 
      v-if="showScrollButton"
      @click="scrollToBottom"
      class="scroll-button"
      type="primary"
      :icon="ArrowDown"
      circle
    />
  </div>
</template>

<script setup lang="ts">
import { ref, nextTick, watch } from 'vue'
import type { Message } from '@/types/chat'

interface Props {
  messages: Message[]
  loading?: boolean
}

const props = withDefaults(defineProps<Props>(), {
  loading: false
})

const emit = defineEmits<{
  retry: [message: Message]
}>()

// è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
const messageContainer = ref<HTMLElement>()
const showScrollButton = ref(false)

const scrollToBottom = () => {
  nextTick(() => {
    if (messageContainer.value) {
      messageContainer.value.scrollTop = messageContainer.value.scrollHeight
    }
  })
}

watch(() => props.messages.length, () => {
  scrollToBottom()
})
</script>
```

**MessageInputç»„ä»¶**:
```vue
<!-- src/components/Chat/MessageInput.vue -->
<template>
  <div class="message-input">
    <div class="input-wrapper">
      <!-- æ–‡ä»¶ä¸Šä¼  -->
      <el-upload
        ref="uploadRef"
        :show-file-list="false"
        :before-upload="handleFileSelect"
        accept=".csv,.xlsx,.json,.txt"
      >
        <el-button :icon="Paperclip" circle />
      </el-upload>
      
      <!-- æ–‡æœ¬è¾“å…¥æ¡† -->
      <el-input
        v-model="inputText"
        type="textarea"
        :rows="1"
        :autosize="{ minRows: 1, maxRows: 5 }"
        placeholder="è¾“å…¥æ¶ˆæ¯... (Shift+Enteræ¢è¡Œï¼ŒEnterå‘é€)"
        @keydown="handleKeydown"
        :disabled="disabled"
        class="message-textarea"
      />
      
      <!-- å‘é€æŒ‰é’® -->
      <el-button
        type="primary"
        :icon="Send"
        @click="handleSend"
        :disabled="!canSend"
        circle
      />
    </div>
    
    <!-- æ–‡ä»¶é¢„è§ˆ -->
    <div v-if="selectedFile" class="file-preview">
      <el-tag closable @close="selectedFile = null">
        <el-icon><Document /></el-icon>
        {{ selectedFile.name }}
      </el-tag>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed } from 'vue'
import { ElMessage } from 'element-plus'

interface Props {
  disabled?: boolean
}

const props = withDefaults(defineProps<Props>(), {
  disabled: false
})

const emit = defineEmits<{
  send: [text: string, file?: File]
  upload: [file: File]
}>()

const inputText = ref('')
const selectedFile = ref<File | null>(null)

const canSend = computed(() => {
  return (inputText.value.trim() || selectedFile.value) && !props.disabled
})

const handleSend = () => {
  if (!canSend.value) return
  
  emit('send', inputText.value.trim(), selectedFile.value || undefined)
  inputText.value = ''
  selectedFile.value = null
}

const handleKeydown = (event: KeyboardEvent) => {
  if (event.key === 'Enter' && !event.shiftKey) {
    event.preventDefault()
    handleSend()
  }
}

const handleFileSelect = (file: File) => {
  selectedFile.value = file
  return false // é˜»æ­¢è‡ªåŠ¨ä¸Šä¼ 
}
</script>
```

### Day 11-14: APIé›†æˆå’ŒçŠ¶æ€ç®¡ç†

#### 5.1 APIæœåŠ¡å°è£…
```typescript
// src/api/chat.ts
import request from '@/utils/request'
import type { CreateConversationDto, SendMessageDto, ApiResponse } from '@/types/api'

export class ChatAPI {
  // åˆ›å»ºæ–°å¯¹è¯
  static async createConversation(data: CreateConversationDto) {
    return request.post<ApiResponse>('/api/conversations', data)
  }
  
  // å‘é€æ¶ˆæ¯ (æ”¯æŒæµå¼å“åº”)
  static async sendMessage(conversationId: string, data: SendMessageDto) {
    return request.post(`/api/conversations/${conversationId}/messages`, data, {
      responseType: 'stream'
    })
  }
  
  // è·å–å¯¹è¯å†å²
  static async getConversations(userId: string) {
    return request.get<ApiResponse>('/api/conversations', {
      params: { user_id: userId }
    })
  }
  
  // è·å–å¯¹è¯æ¶ˆæ¯
  static async getMessages(conversationId: string) {
    return request.get<ApiResponse>(`/api/conversations/${conversationId}/messages`)
  }
  
  // æ–‡ä»¶ä¸Šä¼ 
  static async uploadFile(file: File) {
    const formData = new FormData()
    formData.append('file', file)
    
    return request.post<ApiResponse>('/api/upload', formData, {
      headers: { 'Content-Type': 'multipart/form-data' }
    })
  }
}
```

#### 5.2 PiniaçŠ¶æ€ç®¡ç†
```typescript
// src/stores/chat.ts
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import { ChatAPI } from '@/api/chat'
import type { Conversation, Message } from '@/types/chat'

export const useChatStore = defineStore('chat', () => {
  // çŠ¶æ€
  const conversations = ref<Conversation[]>([])
  const currentConversationId = ref<string | null>(null)
  const messages = ref<Message[]>([])
  const isLoading = ref(false)
  const toolCalls = ref<any[]>([])
  
  // è®¡ç®—å±æ€§
  const currentConversation = computed(() => 
    conversations.value.find(c => c.id === currentConversationId.value)
  )
  
  const currentMessages = computed(() => 
    messages.value.filter(m => m.conversation_id === currentConversationId.value)
  )
  
  // æ“ä½œæ–¹æ³•
  const createConversation = async (title?: string, description?: string) => {
    try {
      isLoading.value = true
      const response = await ChatAPI.createConversation({
        title,
        description,
        user_id: 'current-user', // ä»ç”¨æˆ·çŠ¶æ€è·å–
        api_key: 'user-api-key'  // ä»ç”¨æˆ·çŠ¶æ€è·å–
      })
      
      const newConversation = response.data.conversation
      conversations.value.unshift(newConversation)
      currentConversationId.value = newConversation.id
      
      return newConversation
    } catch (error) {
      console.error('åˆ›å»ºå¯¹è¯å¤±è´¥:', error)
      throw error
    } finally {
      isLoading.value = false
    }
  }
  
  const sendMessage = async (text: string, file?: File) => {
    if (!currentConversationId.value) {
      await createConversation()
    }
    
    try {
      isLoading.value = true
      
      // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°æœ¬åœ°çŠ¶æ€
      const userMessage: Message = {
        id: Date.now().toString(),
        conversation_id: currentConversationId.value!,
        role: 'user',
        content: text,
        timestamp: new Date().toISOString(),
        file_path: file ? URL.createObjectURL(file) : undefined
      }
      messages.value.push(userMessage)
      
      // å‘é€åˆ°åç«¯
      const response = await ChatAPI.sendMessage(currentConversationId.value!, {
        message: text,
        file
      })
      
      // å¤„ç†æµå¼å“åº”
      await handleStreamResponse(response)
      
    } catch (error) {
      console.error('å‘é€æ¶ˆæ¯å¤±è´¥:', error)
      throw error
    } finally {
      isLoading.value = false
    }
  }
  
  const handleStreamResponse = async (response: any) => {
    const reader = response.body.getReader()
    const decoder = new TextDecoder()
    
    let assistantMessage: Message = {
      id: Date.now().toString(),
      conversation_id: currentConversationId.value!,
      role: 'assistant',
      content: '',
      timestamp: new Date().toISOString()
    }
    
    messages.value.push(assistantMessage)
    
    try {
      while (true) {
        const { done, value } = await reader.read()
        if (done) break
        
        const chunk = decoder.decode(value)
        const lines = chunk.split('\n')
        
        for (const line of lines) {
          if (line.startsWith('data: ')) {
            const data = line.slice(6)
            if (data === '[DONE]') return
            
            try {
              const parsed = JSON.parse(data)
              
              if (parsed.type === 'message') {
                assistantMessage.content += parsed.content
              } else if (parsed.type === 'tool_call') {
                toolCalls.value.push(parsed.tool_call)
              } else if (parsed.type === 'tool_result') {
                // æ›´æ–°å·¥å…·è°ƒç”¨ç»“æœ
                const toolCall = toolCalls.value.find(tc => tc.id === parsed.tool_call_id)
                if (toolCall) {
                  toolCall.result = parsed.result
                }
              }
            } catch (e) {
              console.warn('è§£æSSEæ•°æ®å¤±è´¥:', e)
            }
          }
        }
      }
    } finally {
      reader.releaseLock()
    }
  }
  
  return {
    // çŠ¶æ€
    conversations,
    currentConversationId,
    messages,
    isLoading,
    toolCalls,
    // è®¡ç®—å±æ€§
    currentConversation,
    currentMessages,
    // æ–¹æ³•
    createConversation,
    sendMessage
  }
})
```

---

## ğŸ“… Phase 3: æŠ¥å‘Šå±•ç¤ºå¼€å‘ (Week 3)

### Day 15-17: å¤šæ ¼å¼æŠ¥å‘Šæ¸²æŸ“

#### 6.1 æŠ¥å‘Šæ¸²æŸ“ç»„ä»¶æ¶æ„
```vue
<!-- src/components/Reports/ReportRenderer.vue -->
<template>
  <div class="report-renderer">
    <component 
      :is="rendererComponent" 
      :content="content"
      :options="options"
      v-bind="componentProps"
    />
  </div>
</template>

<script setup lang="ts">
import { computed } from 'vue'
import MarkdownRenderer from './MarkdownRenderer.vue'
import CodeRenderer from './CodeRenderer.vue'
import MermaidRenderer from './MermaidRenderer.vue'
import ChartRenderer from './ChartRenderer.vue'
import TableRenderer from './TableRenderer.vue'

interface Props {
  type: 'markdown' | 'code' | 'mermaid' | 'chart' | 'table' | 'html'
  content: string
  options?: Record<string, any>
}

const props = defineProps<Props>()

const rendererMap = {
  markdown: MarkdownRenderer,
  code: CodeRenderer,
  mermaid: MermaidRenderer,
  chart: ChartRenderer,
  table: TableRenderer,
  html: 'div' // ç›´æ¥æ¸²æŸ“HTML
}

const rendererComponent = computed(() => {
  return rendererMap[props.type] || MarkdownRenderer
})

const componentProps = computed(() => {
  if (props.type === 'html') {
    return { innerHTML: props.content }
  }
  return {}
})
</script>
```

#### 6.2 å…·ä½“æ¸²æŸ“å™¨å®ç°

**Markdownæ¸²æŸ“å™¨**:
```vue
<!-- src/components/Reports/MarkdownRenderer.vue -->
<template>
  <div class="markdown-renderer" v-html="renderedContent"></div>
</template>

<script setup lang="ts">
import { computed } from 'vue'
import MarkdownIt from 'markdown-it'
import hljs from 'highlight.js'

interface Props {
  content: string
  options?: {
    breaks?: boolean
    linkify?: boolean
    typographer?: boolean
  }
}

const props = withDefaults(defineProps<Props>(), {
  options: () => ({
    breaks: true,
    linkify: true,
    typographer: true
  })
})

const md = new MarkdownIt({
  html: true,
  ...props.options,
  highlight: (str, lang) => {
    if (lang && hljs.getLanguage(lang)) {
      try {
        return hljs.highlight(str, { language: lang }).value
      } catch {}
    }
    return ''
  }
})

const renderedContent = computed(() => {
  return md.render(props.content)
})
</script>

<style lang="scss">
.markdown-renderer {
  line-height: 1.6;
  
  h1, h2, h3, h4, h5, h6 {
    margin: 1em 0 0.5em 0;
    font-weight: 600;
  }
  
  p {
    margin: 0.5em 0;
  }
  
  code {
    background: var(--el-fill-color-light);
    padding: 0.2em 0.4em;
    border-radius: 3px;
    font-family: 'Monaco', 'Consolas', monospace;
  }
  
  pre {
    background: var(--el-fill-color);
    padding: 1em;
    border-radius: 6px;
    overflow-x: auto;
    
    code {
      background: none;
      padding: 0;
    }
  }
  
  table {
    border-collapse: collapse;
    margin: 1em 0;
    
    th, td {
      border: 1px solid var(--el-border-color);
      padding: 0.5em 1em;
      text-align: left;
    }
    
    th {
      background: var(--el-fill-color-light);
      font-weight: 600;
    }
  }
}
</style>
```

**Mermaidå›¾è¡¨æ¸²æŸ“å™¨**:
```vue
<!-- src/components/Reports/MermaidRenderer.vue -->
<template>
  <div class="mermaid-renderer">
    <div ref="mermaidContainer" class="mermaid-container"></div>
    <div v-if="error" class="error-message">
      <el-alert type="error" :title="error" show-icon />
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted, watch } from 'vue'
import mermaid from 'mermaid'

interface Props {
  content: string
  options?: {
    theme?: 'default' | 'dark' | 'forest' | 'neutral'
  }
}

const props = withDefaults(defineProps<Props>(), {
  options: () => ({ theme: 'default' })
})

const mermaidContainer = ref<HTMLElement>()
const error = ref<string>('')

onMounted(() => {
  mermaid.initialize({
    startOnLoad: false,
    theme: props.options.theme,
    securityLevel: 'loose'
  })
  renderMermaid()
})

watch(() => props.content, renderMermaid)

const renderMermaid = async () => {
  if (!mermaidContainer.value || !props.content) return
  
  try {
    error.value = ''
    const { svg } = await mermaid.render('mermaid-diagram', props.content)
    mermaidContainer.value.innerHTML = svg
  } catch (err) {
    error.value = `Mermaidæ¸²æŸ“é”™è¯¯: ${err}`
    console.error('Mermaid render error:', err)
  }
}
</script>

<style lang="scss">
.mermaid-renderer {
  .mermaid-container {
    text-align: center;
    margin: 1em 0;
    
    svg {
      max-width: 100%;
      height: auto;
    }
  }
  
  .error-message {
    margin: 1em 0;
  }
}
</style>
```

### Day 18-21: å·¥å…·è°ƒç”¨å¯è§†åŒ–

#### 7.1 å·¥å…·è°ƒç”¨æµç¨‹å±•ç¤º
```vue
<!-- src/components/Chat/ToolCallVisualization.vue -->
<template>
  <div class="tool-call-visualization">
    <el-card class="tool-call-card">
      <template #header>
        <div class="tool-header">
          <el-icon><Tools /></el-icon>
          <span>å·¥å…·è°ƒç”¨è¿‡ç¨‹</span>
          <el-tag :type="statusType" size="small">{{ statusText }}</el-tag>
        </div>
      </template>
      
      <!-- å·¥å…·è°ƒç”¨æ­¥éª¤ -->
      <el-steps 
        :active="currentStep" 
        :finish-status="allCompleted ? 'success' : 'process'"
        direction="vertical"
      >
        <el-step 
          v-for="(step, index) in toolSteps" 
          :key="step.id"
          :title="step.name"
          :description="step.description"
          :status="step.status"
        >
          <template #icon>
            <el-icon v-if="step.status === 'process'">
              <Loading />
            </el-icon>
            <el-icon v-else-if="step.status === 'success'" class="success-icon">
              <Check />
            </el-icon>
            <el-icon v-else-if="step.status === 'error'" class="error-icon">
              <Close />
            </el-icon>
          </template>
          
          <!-- æ­¥éª¤è¯¦æƒ… -->
          <div class="step-content">
            <!-- è¾“å…¥å‚æ•° -->
            <div v-if="step.input" class="step-input">
              <el-collapse>
                <el-collapse-item title="è¾“å…¥å‚æ•°" name="input">
                  <CodeRenderer 
                    :content="JSON.stringify(step.input, null, 2)"
                    language="json"
                  />
                </el-collapse-item>
              </el-collapse>
            </div>
            
            <!-- æ‰§è¡Œç»“æœ -->
            <div v-if="step.output" class="step-output">
              <el-collapse>
                <el-collapse-item title="æ‰§è¡Œç»“æœ" name="output">
                  <ReportRenderer 
                    :type="step.output.type || 'markdown'"
                    :content="step.output.content"
                  />
                </el-collapse-item>
              </el-collapse>
            </div>
            
            <!-- é”™è¯¯ä¿¡æ¯ -->
            <div v-if="step.error" class="step-error">
              <el-alert 
                type="error" 
                :title="step.error.message"
                :description="step.error.details"
                show-icon
              />
            </div>
          </div>
        </el-step>
      </el-steps>
      
      <!-- æœ€ç»ˆç»“æœ -->
      <div v-if="finalResult" class="final-result">
        <el-divider content-position="left">
          <el-icon><Trophy /></el-icon>
          æœ€ç»ˆç»“æœ
        </el-divider>
        <ReportRenderer 
          :type="finalResult.type"
          :content="finalResult.content"
        />
      </div>
    </el-card>
  </div>
</template>

<script setup lang="ts">
import { computed } from 'vue'
import type { ToolCall } from '@/types/chat'

interface Props {
  toolCalls: ToolCall[]
}

const props = defineProps<Props>()

const toolSteps = computed(() => {
  return props.toolCalls.map((call, index) => ({
    id: call.id,
    name: call.function?.name || `å·¥å…· ${index + 1}`,
    description: call.function?.description || '',
    status: call.status || 'wait',
    input: call.function?.arguments,
    output: call.result,
    error: call.error
  }))
})

const currentStep = computed(() => {
  const processingIndex = toolSteps.value.findIndex(step => step.status === 'process')
  return processingIndex === -1 ? toolSteps.value.length : processingIndex
})

const allCompleted = computed(() => {
  return toolSteps.value.every(step => step.status === 'success')
})

const statusType = computed(() => {
  if (toolSteps.value.some(step => step.status === 'error')) return 'danger'
  if (allCompleted.value) return 'success'
  return 'warning'
})

const statusText = computed(() => {
  if (toolSteps.value.some(step => step.status === 'error')) return 'æ‰§è¡Œå¤±è´¥'
  if (allCompleted.value) return 'æ‰§è¡Œå®Œæˆ'
  return 'æ‰§è¡Œä¸­'
})

const finalResult = computed(() => {
  if (!allCompleted.value) return null
  
  const lastStep = toolSteps.value[toolSteps.value.length - 1]
  return lastStep.output
})
</script>

<style lang="scss">
.tool-call-visualization {
  margin: 1em 0;
  
  .tool-call-card {
    .tool-header {
      display: flex;
      align-items: center;
      gap: 0.5em;
    }
  }
  
  .step-content {
    margin: 0.5em 0;
    
    .step-input,
    .step-output {
      margin: 0.5em 0;
    }
    
    .step-error {
      margin: 0.5em 0;
    }
  }
  
  .final-result {
    margin-top: 2em;
    padding-top: 1em;
  }
  
  .success-icon {
    color: var(--el-color-success);
  }
  
  .error-icon {
    color: var(--el-color-danger);
  }
}
</style>
```

---

## ğŸ“… Phase 4: ä¼˜åŒ–å’Œéƒ¨ç½² (Week 4)

### Day 22-24: æ€§èƒ½ä¼˜åŒ–

#### 8.1 è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–
```vue
<!-- src/components/Chat/VirtualMessageList.vue -->
<template>
  <div class="virtual-message-list" ref="containerRef">
    <div 
      class="virtual-content"
      :style="{ height: totalHeight + 'px' }"
    >
      <div 
        class="virtual-viewport"
        :style="{ transform: `translateY(${offsetY}px)` }"
      >
        <MessageItem
          v-for="item in visibleItems"
          :key="item.id"
          :message="item"
          :style="{ height: itemHeight + 'px' }"
        />
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, onMounted, onUnmounted } from 'vue'
import type { Message } from '@/types/chat'

interface Props {
  messages: Message[]
  itemHeight?: number
  containerHeight?: number
}

const props = withDefaults(defineProps<Props>(), {
  itemHeight: 80,
  containerHeight: 400
})

const containerRef = ref<HTMLElement>()
const scrollTop = ref(0)

const totalHeight = computed(() => 
  props.messages.length * props.itemHeight
)

const visibleStart = computed(() => 
  Math.floor(scrollTop.value / props.itemHeight)
)

const visibleEnd = computed(() => 
  Math.min(
    visibleStart.value + Math.ceil(props.containerHeight / props.itemHeight) + 1,
    props.messages.length
  )
)

const visibleItems = computed(() => 
  props.messages.slice(visibleStart.value, visibleEnd.value)
)

const offsetY = computed(() => 
  visibleStart.value * props.itemHeight
)

const handleScroll = () => {
  if (containerRef.value) {
    scrollTop.value = containerRef.value.scrollTop
  }
}

onMounted(() => {
  containerRef.value?.addEventListener('scroll', handleScroll)
})

onUnmounted(() => {
  containerRef.value?.removeEventListener('scroll', handleScroll)
})
</script>
```

#### 8.2 ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
```typescript
// src/router/index.ts
import { createRouter, createWebHistory } from 'vue-router'

const router = createRouter({
  history: createWebHistory(),
  routes: [
    {
      path: '/',
      redirect: '/chat'
    },
    {
      path: '/chat',
      name: 'Chat',
      component: () => import('@/views/Chat/ChatInterface.vue'), // æ‡’åŠ è½½
      meta: { title: 'æ™ºèƒ½å¯¹è¯' }
    },
    {
      path: '/history',
      name: 'History',
      component: () => import('@/views/History/HistoryManager.vue'),
      meta: { title: 'å†å²è®°å½•' }
    },
    {
      path: '/reports',
      name: 'Reports',
      component: () => import('@/views/Reports/ReportViewer.vue'),
      meta: { title: 'æŠ¥å‘ŠæŸ¥çœ‹' }
    }
  ]
})

export default router
```

### Day 25-28: æµ‹è¯•å’Œéƒ¨ç½²

#### 9.1 å•å…ƒæµ‹è¯•
```typescript
// tests/unit/components/MessageItem.spec.ts
import { mount } from '@vue/test-utils'
import { describe, it, expect } from 'vitest'
import MessageItem from '@/components/Chat/MessageItem.vue'

describe('MessageItem', () => {
  it('renders user message correctly', () => {
    const message = {
      id: '1',
      role: 'user',
      content: 'Hello, AI!',
      timestamp: '2024-01-01T00:00:00Z'
    }
    
    const wrapper = mount(MessageItem, {
      props: { message }
    })
    
    expect(wrapper.text()).toContain('Hello, AI!')
    expect(wrapper.classes()).toContain('user-message')
  })
  
  it('renders assistant message with markdown', () => {
    const message = {
      id: '2',
      role: 'assistant',
      content: '# Hello\n\nThis is **bold** text.',
      timestamp: '2024-01-01T00:00:00Z'
    }
    
    const wrapper = mount(MessageItem, {
      props: { message }
    })
    
    expect(wrapper.html()).toContain('<h1>Hello</h1>')
    expect(wrapper.html()).toContain('<strong>bold</strong>')
  })
})
```

#### 9.2 æ„å»ºå’Œéƒ¨ç½²é…ç½®
```typescript
// vite.config.ts
export default defineConfig({
  plugins: [vue()],
  build: {
    target: 'es2015',
    outDir: 'dist',
    assetsDir: 'assets',
    sourcemap: false,
    rollupOptions: {
      output: {
        manualChunks: {
          'element-plus': ['element-plus'],
          'chart-libs': ['echarts', 'mermaid'],
          'utils': ['lodash-es', 'dayjs']
        }
      }
    }
  },
  server: {
    proxy: {
      '/api': {
        target: 'http://localhost:5000',
        changeOrigin: true
      }
    }
  }
})
```

---

## ğŸ¯ **æ–¹æ¡ˆAæ€»ç»“**

### âœ… **æ ¸å¿ƒä¼˜åŠ¿**

1. **å¼€å‘é€Ÿåº¦å¿«**: 3-4å‘¨ vs 6-8å‘¨è‡ªä¸»å¼€å‘
2. **ä»£ç è´¨é‡é«˜**: åŸºäºæˆç†Ÿå¼€æºé¡¹ç›®
3. **æŠ€æœ¯æ ˆç»Ÿä¸€**: Vue 3 + Element Plus + TypeScript
4. **åŠŸèƒ½å®Œæ•´**: è¦†ç›–æ‰€æœ‰éœ€æ±‚åŠŸèƒ½
5. **å¯ç»´æŠ¤æ€§å¥½**: æ¸…æ™°çš„ç»„ä»¶æ¶æ„å’Œä»£ç ç»“æ„

### ğŸ“Š **å…·ä½“å®æ–½æ•ˆæœ**

- **Week 1**: åŸºç¡€æ¶æ„æ­å»ºå®Œæˆ âœ…
- **Week 2**: èŠå¤©åŠŸèƒ½å®Œæ•´å®ç° âœ…  
- **Week 3**: æŠ¥å‘Šå±•ç¤ºå’Œå·¥å…·å¯è§†åŒ– âœ…
- **Week 4**: æ€§èƒ½ä¼˜åŒ–å’Œéƒ¨ç½²å‡†å¤‡ âœ…

### ğŸ¨ **æœ€ç»ˆäº§å“ç‰¹æ€§**

- ğŸ¤– **æ™ºèƒ½å¯¹è¯**: ç±»ChatGPTçš„æµç•…ä½“éªŒ
- ğŸ”§ **å·¥å…·å¯è§†åŒ–**: å®æ—¶å±•ç¤ºAIå·¥å…·è°ƒç”¨è¿‡ç¨‹
- ğŸ“Š **å¤šæ ¼å¼æŠ¥å‘Š**: æ”¯æŒMarkdownã€å›¾è¡¨ã€Mermaidç­‰
- ğŸ“± **å“åº”å¼è®¾è®¡**: å®Œç¾é€‚é…æ¡Œé¢å’Œç§»åŠ¨ç«¯
- âš¡ **é«˜æ€§èƒ½**: è™šæ‹Ÿæ»šåŠ¨ã€æ‡’åŠ è½½ç­‰ä¼˜åŒ–

### ğŸ’¡ **æŠ€æœ¯äº®ç‚¹**

- **ç»„ä»¶åŒ–æ¶æ„**: é«˜åº¦å¤ç”¨çš„Vue 3ç»„ä»¶
- **TypeScript**: å®Œæ•´çš„ç±»å‹å®‰å…¨
- **æµå¼å“åº”**: å®æ—¶æ˜¾ç¤ºAIå›å¤è¿‡ç¨‹
- **çŠ¶æ€ç®¡ç†**: Piniaç»Ÿä¸€çŠ¶æ€ç®¡ç†
- **ç°ä»£åŒ–UI**: Element Plusç¾è§‚ç•Œé¢

è¿™ä¸ªæ–¹æ¡ˆå°†ä¸ºæ‚¨æä¾›ä¸€ä¸ª**ç°ä»£åŒ–ã€é«˜æ€§èƒ½ã€ç”¨æˆ·å‹å¥½**çš„æ™ºèƒ½æ•°æ®åˆ†æå‰ç«¯åº”ç”¨ï¼

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.2 - 2024-12-30 ğŸ“‹  
- ğŸ“‹ **Phase 2 æ–¹æ¡ˆç¡®å®š**: 4å¤©è¯¦ç»†å®æ–½è®¡åˆ’åˆ¶å®šå®Œæˆ
- ğŸ—ï¸ **æŠ€æœ¯æ¶æ„ç»†åŒ–**: APIå±‚ã€çŠ¶æ€ç®¡ç†ã€ç»„ä»¶å±‚å®Œæ•´è®¾è®¡
- ğŸ“ **æ–‡ä»¶ç»“æ„è§„åˆ’**: 21ä¸ªæ ¸å¿ƒæ–‡ä»¶çš„åˆ›å»ºè®¡åˆ’
- ğŸ¯ **éªŒæ”¶æ ‡å‡†**: åŠŸèƒ½éªŒæ”¶å’ŒæŠ€æœ¯éªŒæ”¶æ ‡å‡†æ˜ç¡®
- ğŸ”„ **å‡†å¤‡å¼€å§‹**: Phase 2æ ¸å¿ƒåŠŸèƒ½å¼€å‘å³å°†å¯åŠ¨

### v1.1 - 2024-12-29 âœ…
- âœ… **Phase 1 å®Œæˆ**: åŸºç¡€æ¶æ„æ­å»ºå®Œæˆ
- âœ… **é¡¹ç›®ç»“æ„**: 5ä¸ªæ ¸å¿ƒé¡µé¢ç»„ä»¶å·²åˆ›å»ºå®Œæˆ
  - `HomePage.vue` - æ¬¢è¿é¡µé¢ (æ¸å˜èƒŒæ™¯ + åŠŸèƒ½å¡ç‰‡)
  - `ChatInterface.vue` - æ™ºèƒ½å¯¹è¯é¡µé¢ (æ¶ˆæ¯åˆ—è¡¨ + è¾“å…¥æ¡†)
  - `ReportCenter.vue` - æŠ¥å‘Šä¸­å¿ƒ (æŠ¥å‘Šåˆ—è¡¨ + è¿‡æ»¤å™¨)
  - `ToolsPanel.vue` - å·¥å…·é¢æ¿ (åˆ†ç±»æ ‡ç­¾ + å·¥å…·å¡ç‰‡)
  - `Settings.vue` - ç³»ç»Ÿè®¾ç½® (å¤šæ ‡ç­¾é¡µé…ç½®)
- âœ… **å“åº”å¼è®¾è®¡**: å®Œç¾æ”¯æŒæ¡Œé¢ç«¯ã€å¹³æ¿ç«¯ã€æ‰‹æœºç«¯
- âœ… **å¸ƒå±€ç³»ç»Ÿ**: æ·±è‰²ä¾§è¾¹æ å¯¼èˆª + ä¸»å†…å®¹åŒºåŸŸ
- âœ… **Bugä¿®å¤**: ä¸»é¡µé»‘å±é—®é¢˜ (CSSæ ·å¼å†²çª) å·²è§£å†³
- ğŸ”„ **Phase 2 å‡†å¤‡**: APIé›†æˆå’Œæ ¸å¿ƒåŠŸèƒ½å¼€å‘è®¡åˆ’å·²åˆ¶å®š
- ğŸ“Š **è¿›åº¦æ›´æ–°**: æ•´ä½“é¡¹ç›®è¿›åº¦è¾¾åˆ°25%

### v1.1 - 2024-12-29 âœ…
- âœ… **Phase 1 å®Œæˆ**: åŸºç¡€æ¶æ„æ­å»ºå®Œæˆ
- âœ… **é¡¹ç›®ç»“æ„**: 5ä¸ªæ ¸å¿ƒé¡µé¢ç»„ä»¶å·²åˆ›å»ºå®Œæˆ
  - `HomePage.vue` - æ¬¢è¿é¡µé¢ (æ¸å˜èƒŒæ™¯ + åŠŸèƒ½å¡ç‰‡)
  - `ChatInterface.vue` - æ™ºèƒ½å¯¹è¯é¡µé¢ (æ¶ˆæ¯åˆ—è¡¨ + è¾“å…¥æ¡†)
  - `ReportCenter.vue` - æŠ¥å‘Šä¸­å¿ƒ (æŠ¥å‘Šåˆ—è¡¨ + è¿‡æ»¤å™¨)
  - `ToolsPanel.vue` - å·¥å…·é¢æ¿ (åˆ†ç±»æ ‡ç­¾ + å·¥å…·å¡ç‰‡)
  - `Settings.vue` - ç³»ç»Ÿè®¾ç½® (å¤šæ ‡ç­¾é¡µé…ç½®)
- âœ… **å“åº”å¼è®¾è®¡**: å®Œç¾æ”¯æŒæ¡Œé¢ç«¯ã€å¹³æ¿ç«¯ã€æ‰‹æœºç«¯
- âœ… **å¸ƒå±€ç³»ç»Ÿ**: æ·±è‰²ä¾§è¾¹æ å¯¼èˆª + ä¸»å†…å®¹åŒºåŸŸ
- âœ… **Bugä¿®å¤**: ä¸»é¡µé»‘å±é—®é¢˜ (CSSæ ·å¼å†²çª) å·²è§£å†³
- ğŸ”„ **Phase 2 å‡†å¤‡**: APIé›†æˆå’Œæ ¸å¿ƒåŠŸèƒ½å¼€å‘è®¡åˆ’å·²åˆ¶å®š
- ğŸ“Š **è¿›åº¦æ›´æ–°**: æ•´ä½“é¡¹ç›®è¿›åº¦è¾¾åˆ°25%

### v1.0 - 2024-12-28 ğŸ“‹
- ğŸ“‹ **åˆå§‹ç‰ˆæœ¬**: å®Œæ•´çš„4é˜¶æ®µå¼€å‘è®¡åˆ’åˆ¶å®š
- ğŸ¯ **æŠ€æœ¯æ–¹æ¡ˆ**: åŸºäºå¼€æºé¡¹ç›®çš„å¿«é€Ÿå¼€å‘æ–¹æ¡ˆç¡®å®š
- ğŸ“š **å¼€æºè°ƒç ”**: 3ä¸ªæ ¸å¿ƒå¼€æºé¡¹ç›®åˆ†æå®Œæˆ
- ğŸ—ï¸ **æ¶æ„è®¾è®¡**: Vue 3 + Element Plus + ViteæŠ€æœ¯æ ˆç¡®å®š

---

**å½“å‰çŠ¶æ€**: Phase 1 âœ… å·²å®Œæˆ | Phase 2 ğŸ”„ è¯¦ç»†æ–¹æ¡ˆå·²åˆ¶å®šï¼Œå‡†å¤‡å¼€å§‹å®æ–½ 